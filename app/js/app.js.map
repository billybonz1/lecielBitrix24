{"version":3,"sources":["app-install.jsx","app-templates.jsx","app.jsx"],"names":[],"mappings":"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","file":"app.js","sourceRoot":"/source/","sourcesContent":["/* Installation */\r\n\r\napplication.prototype.prepareEntity = function(arEntityDesc) {\r\n    var batch = [];\r\n    batch.push(['entity.add', {'ENTITY': arEntityDesc.NAME, 'NAME': arEntityDesc.DESC, 'ACCESS': {AU: 'W'}}]);\r\n    batch.push(['entity.update', {'ENTITY': arEntityDesc.NAME, 'ACCESS': {AU: 'W'}}]);\r\n\r\n    for(let indexProperty in arEntityDesc.PROPERTIES)\r\n        batch.push(['entity.item.property.add', {\r\n            ENTITY: arEntityDesc.NAME,\r\n            PROPERTY: arEntityDesc.PROPERTIES[indexProperty].CODE,\r\n            NAME: arEntityDesc.PROPERTIES[indexProperty].NAME,\r\n            TYPE: arEntityDesc.PROPERTIES[indexProperty].TYPE\r\n        }]);\r\n\r\n    return batch;\r\n};\r\n\r\n// Создание хранилищ\r\napplication.prototype.finishInstallation = function(arInfo){\r\n    var arInfoEntity  = {\r\n        NAME: \"info\",\r\n        DESC: 'Хранилище с установовчными данными приложения',\r\n        PROPERTIES: [\r\n            {CODE: 'DEALER_CONTACT_TYPE', NAME: 'Тип Контактов Дилеров', TYPE: 'S'},\r\n            {CODE: 'CURRENCY', NAME: 'Валюта', TYPE: 'S'},\r\n            {CODE: 'RATE', NAME: 'Курс доллара', TYPE: 'N'}\r\n        ]\r\n    };\r\n\r\n    var arDealingsEntity  = {\r\n        NAME: \"dealings\",\r\n        DESC: 'Хранилище для хранения сделок с дилерами',\r\n        PROPERTIES: [\r\n            {CODE: 'ORDER_ID', NAME: 'ID сделки', TYPE: 'N'},\r\n            {CODE: 'DEALER_ID', NAME: 'ID дилера', TYPE: 'N'},\r\n            {CODE: 'ARTICUL', NAME: 'Артикул сделки', TYPE: 'S'},\r\n            {CODE: 'DATE_START', NAME: 'Дата получения заказа', TYPE: 'S'},\r\n            {CODE: 'DATE_END', NAME: 'Дата отправки заказа', TYPE: 'S'},\r\n            {CODE: 'DATE_STATUS', NAME: 'Статус отправки', TYPE: 'S'},\r\n            {CODE: 'PAYMENT_STATUS', NAME: 'Статус оплаты', TYPE: 'S'},\r\n            {CODE: 'NAME', NAME: 'Имя сделки', TYPE: 'S'},\r\n            {CODE: 'TOTAL_SUM', NAME: 'Сумма сделки итого', TYPE: 'N'},\r\n            {CODE: 'CURRENCY_VALUE', NAME: 'Курс доллара', TYPE: 'N'}\r\n        ]\r\n    };\r\n    var arDealingsItemsEntity  = {\r\n        NAME: \"dealings_items\",\r\n        DESC: 'Хранилище для хранения позиций в сделках',\r\n        PROPERTIES: [\r\n            {CODE: 'ITEM_ID', NAME: 'ID позиции', TYPE: 'N'},\r\n            {CODE: 'ORDER_ID', NAME: 'ID сделки', TYPE: 'N'},\r\n            {CODE: 'ITEM_PRICE', NAME: 'Цена позиции', TYPE: 'N'}\r\n        ]\r\n    };\r\n\r\n    var arDealersPriceEntity  = {\r\n        NAME: \"dealings_price\",\r\n        DESC: 'Хранилище для хранения цен позиций для каждого',\r\n        PROPERTIES: [\r\n            {CODE: 'ITEM_ID', NAME: 'ID позиции', TYPE: 'N'},\r\n            {CODE: 'DEALER_ID', NAME: 'ID дилера', TYPE: 'N'},\r\n            {CODE: 'DEALER_PRICE', NAME: 'Цена позиции', TYPE: 'N'},\r\n            {CODE: 'ITEM_NAME', NAME: 'Имя позиции', TYPE: 'S'}\r\n        ]\r\n    };\r\n\r\n    var arEntityBatch = this.prepareEntity(arInfoEntity);\r\n\r\n    arEntityBatch.push(['entity.item.add', {\r\n        ENTITY: 'info',\r\n        DATE_ACTIVE_FROM: new Date(),\r\n        NAME: 'Тип Контактов Дилеров',\r\n        PROPERTY_VALUES: {\r\n            DEALER_CONTACT_TYPE: arInfo.DEALER_CONTACT_TYPE\r\n        }\r\n    }]);\r\n\r\n    var curapp = this;\r\n\r\n    BX24.callBatch(arEntityBatch, function(result) {\r\n        BX24.callMethod('entity.item.get', {\r\n                ENTITY: \"info\",\r\n                SORT: {DATE_ACTIVE_FROM: 'ASC'}\r\n            },\r\n\r\n            function (result) {\r\n                if(result.error()){\r\n                    console.error(result.error());\r\n                }else{\r\n                    BX24.installFinish();\r\n                }\r\n            }\r\n        );\r\n    });\r\n\r\n\r\n};\r\n\r\napplication.prototype.chooseContactGroup = function(dialog){\r\n    BX24.callMethod(\r\n        \"crm.status.entity.items\",\r\n        {\r\n            entityId: 'CONTACT_TYPE'\r\n        },\r\n        function(result)\r\n        {\r\n            if(result.error())\r\n                console.error(result.error());\r\n            else\r\n                console.dir(result.data());\r\n            var resultHTML = '';\r\n            result.data().forEach(function(item, i, arr) {\r\n                resultHTML += \"<button data-id='\"+item.STATUS_ID+\"' class='mdl-button mdl-js-button mdl-button--raised mdl-button--colored'>\"+item.NAME+\"</button>\";\r\n            });\r\n            dialog.querySelector('.mdl-dialog__content').innerHTML = resultHTML;\r\n        }\r\n    );\r\n};\r\n\r\nvar app = new application();\r\n","// React Templates\r\n\r\nfunction UserName(props) {\r\n    return (\r\n        <span className=\"mdl-chip mdl-chip--contact\">\r\n                <span className=\"mdl-chip__contact mdl-color--teal mdl-color-text--white\">{props.firstletter}</span>\r\n                <span className=\"mdl-chip__text\">{props.name}</span>\r\n        </span>\r\n    );\r\n}\r\n\r\n\r\nvar DealersBox = React.createClass({\r\n    render: function() {\r\n        return (\r\n\r\n            <table className=\"mdl-data-table mdl-js-data-table mdl-shadow--2dp dealList\">\r\n                <thead>\r\n                <tr>\r\n                    <th>ID</th>\r\n                    <th className=\"mdl-data-table__cell--non-numeric\">Имя дилера</th>\r\n                    <th className=\"mdl-data-table__cell--non-numeric\">Сумма долга</th>\r\n                </tr>\r\n                </thead>\r\n\r\n                <DealersList data={this.props.data} />\r\n\r\n            </table>\r\n        );\r\n    }\r\n});\r\n\r\n\r\n\r\nvar DealersList = React.createClass({\r\n    render: function() {\r\n        var dealersNodes = this.props.data.map(function(dealer) {\r\n            return (\r\n                <tr className={dealer.rowClass}>\r\n                    <th scope=\"row\">{dealer.ID}</th>\r\n                    <td className=\"mdl-data-table__cell--non-numeric\">{dealer.NAME} {dealer.LAST_NAME}</td>\r\n                    <td className=\"mdl-data-table__cell--non-numeric\">{dealer.DEBT_SUM}</td>\r\n                </tr>\r\n            );\r\n        });\r\n        return (\r\n            <tbody>\r\n                {dealersNodes}\r\n            </tbody>\r\n        );\r\n    }\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","// Application\r\n\r\nfunction application(){\r\n}\r\n\r\n\r\n\r\napplication.prototype.isDataLoaded = function(){\r\n    for(let keyIndex in this.appLoadedKeys)\r\n        if (this.appLoadedKeys[keyIndex].loaded !== true) return;\r\n    this.processUserInterface();\r\n};\r\n\r\napplication.prototype.addLoadedKey = function(aKey){\r\n    this.appLoadedKeys[aKey] = {\r\n        loaded: false\r\n    };\r\n};\r\n\r\n\r\napplication.prototype.displayCurrentUser = function () {\r\n    this.appLoadedKeys = [];\r\n    var curapp = this;\r\n    curapp.addLoadedKey('current-user');\r\n    curapp.addLoadedKey('dealers-list');\r\n    BX24.callMethod(\r\n        'user.current',\r\n        {},\r\n        function (result) {\r\n            curapp.currentUser = result.data().NAME + ' ' + result.data().LAST_NAME;\r\n            curapp.appLoadedKeys['current-user'].loaded = true;\r\n            curapp.isDataLoaded();\r\n        }\r\n    );\r\n};\r\n\r\n\r\n\r\napplication.prototype.displayDealersList = function(){\r\n//Выводим список дилеров и их долгов на первом экране\r\n    var curapp = this;\r\n    curapp.arDealerList = [];\r\n    BX24.callMethod('entity.item.get', {\r\n            ENTITY: \"info\",\r\n            SORT: {DATE_ACTIVE_FROM: 'ASC'}\r\n        },\r\n\r\n        function (result) {\r\n            if(result.error()){\r\n                console.error(result.error());\r\n            }else{\r\n                var DEALERS_CONTACT_TYPE = result.data()[0].PROPERTY_VALUES.DEALER_CONTACT_TYPE;\r\n                BX24.callMethod(\r\n                    \"crm.contact.list\",\r\n                    {\r\n                        order: { \"DATE_CREATE\": \"ASC\" },\r\n                        filter: { \"TYPE_ID\": DEALERS_CONTACT_TYPE },\r\n                        select: [ \"ID\", \"NAME\", \"LAST_NAME\", \"TYPE_ID\", \"SOURCE_ID\" ]\r\n                    },\r\n                    function(result)\r\n                    {\r\n                        if(result.error()){\r\n                            console.error(result.error());\r\n                        } else {\r\n                            curapp.arDealerList = curapp.arDealerList.concat(result.data());\r\n\r\n                            if(result.more()){\r\n                                result.next();\r\n                            }else{\r\n                                curapp.currentDealerDealList(0);\r\n                            }\r\n\r\n                        }\r\n                    }\r\n                );\r\n            }\r\n        }\r\n    );\r\n};\r\n\r\n\r\n\r\napplication.prototype.currentDealerDealList = function(i){\r\n    var curapp = this;\r\n    curapp.DEBT_SUM = 0;\r\n    BX24.callMethod(\r\n        \"crm.deal.list\",\r\n        {\r\n            order: { \"STAGE_ID\": \"ASC\" },\r\n            filter: { \"CONTACT_ID\": curapp.arDealerList[i].ID},\r\n            select: [ \"OPPORTUNITY\", \"CURRENCY_ID\", \"STAGE_ID\"]\r\n        },\r\n        function(result)\r\n        {\r\n            curapp.DEBT_SUM = 0;\r\n            if(result.error())\r\n                console.error(result.error());\r\n            else\r\n            {\r\n                var dataDeal = result.data();\r\n                for (let indexDeal in dataDeal){\r\n                    if(dataDeal[indexDeal].STAGE_ID != \"WON\"){\r\n                        curapp.DEBT_SUM += parseFloat(dataDeal[indexDeal].OPPORTUNITY);\r\n                    }\r\n                }\r\n                if(result.more()){\r\n                    result.next();\r\n                }else{\r\n                    var rowClass = \"\";\r\n                    if(curapp.DEBT_SUM == 0){\r\n                        rowClass = 'row-green';\r\n                    }else if(curapp.DEBT_SUM <= 2000){\r\n                        rowClass = 'row-yellow';\r\n                    }else if(curapp.DEBT_SUM > 2000 && curapp.DEBT_SUM <= 8000){\r\n                        rowClass = 'row-orange';\r\n                    }else if(curapp.DEBT_SUM > 8000){\r\n                        rowClass = 'row-red';\r\n                    }\r\n\r\n                    curapp.arDealerList[i].rowClass = rowClass;\r\n                    curapp.arDealerList[i].DEBT_SUM = curapp.DEBT_SUM;\r\n\r\n                    var j = i + 1;\r\n                    if(curapp.arDealerList.length == j){\r\n                        curapp.appLoadedKeys['dealers-list'].loaded = true;\r\n                        curapp.isDataLoaded();\r\n                    }else{\r\n                        curapp.currentDealerDealList(j);\r\n                    }\r\n\r\n                }\r\n\r\n            }\r\n        }\r\n    );\r\n};\r\n\r\n\r\n\r\n\r\napplication.prototype.processUserInterface = function(screen){\r\n    var curapp = this;\r\n    ReactDOM.render(\r\n        <div class=\"mdl-grid\">\r\n            <div className=\"mdl-cell mdl-cell--12-col\">\r\n                <UserName firstletter={curapp.currentUser[0]} name={curapp.currentUser} />\r\n            </div>\r\n            <div className=\"mdl-cell mdl-cell--12-col\">\r\n                <DealersBox data={curapp.arDealerList} />\r\n            </div>\r\n        </div>,\r\n        document.getElementById('content')\r\n    );\r\n    console.log(curapp.arDealerList);\r\n    curapp.resizeFrame();\r\n};\r\n\r\n\r\n\r\napplication.prototype.resizeFrame = function(){\r\n    var currentSize  = BX24.getScrollSize();\r\n    var minHeight = currentSize.scrollHeight;\r\n    if(minHeight < 400) minHeight = 400;\r\n    BX24.resizeWindow(this.FrameWidth, minHeight);\r\n};\r\n\r\n\r\napplication.prototype.saveFrameWidth  = function() {\r\n    this.FrameWidth = document.getElementById(\"app\").offsetWidth;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"]}